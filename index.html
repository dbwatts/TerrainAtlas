<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Atlas Flipbook</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="js/turn.min.js"></script>
  <style>
    body { background: #eaeaea; display: flex; justify-content: center; align-items: center; height: 100vh; }
    #flipbook {
      width: 90%;
      height: 90vh;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    #flipbook .page {
      background: white;
      overflow: hidden;
    }
  </style>
</head>
<body>

<div id="flipbook"></div>

<script>
  const pdfUrl = 'TerrainAtlas_DW_PortfolioCompressed.pdf'; // replace with your actual filename if needed

  // PDF.js logic to render pages as images for Turn.js
  // Lightweight adaptation for PDFs with facing spreads

  // Load PDF.js
  const script = document.createElement('script');
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js';
  document.head.appendChild(script);

  script.onload = () => {
    const container = document.getElementById('flipbook');
    pdfjsLib.getDocument(pdfUrl).promise.then(pdf => {
      const numPages = pdf.numPages;

      const loadPage = pageNum => {
        return pdf.getPage(pageNum).then(page => {
          const scale = 2;
          const viewport = page.getViewport({ scale });

          const canvas = document.createElement('canvas');
          const context = canvas.getContext('2d');
          canvas.height = viewport.height;
          canvas.width = viewport.width;

          return page.render({ canvasContext: context, viewport }).promise.then(() => {
            const pageDiv = document.createElement('div');
            pageDiv.className = 'page';
            pageDiv.innerHTML = `<img src="${canvas.toDataURL()}" style="width:100%;height:auto;">`;
            container.appendChild(pageDiv);
          });
        });
      };

      // Load all pages
      const loadAllPages = async () => {
        for (let i = 1; i <= numPages; i++) {
          await loadPage(i);
        }

        // Initialize Turn.js after all pages are loaded
        $('#flipbook').turn({
          width: '100%',
          height: '100%',
          autoCenter: true
        });
      };

      loadAllPages();
    });
  };
</script>

</body>
</html>
